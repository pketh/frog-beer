// Generated by CoffeeScript 1.9.0
(function() {
  var EMAIL_INPUT, NAME_INPUT, addErrorsToEmptyFields, clearFieldErrors, submitSignUpForm;

  EMAIL_INPUT = $('input[name="email"]');

  NAME_INPUT = $('input[name="name"]');

  submitSignUpForm = function(email, name) {
    return $.ajax({
      url: '/sign-up',
      type: 'POST',
      data: {
        'email': email,
        'name': name
      },
      success: function(response) {
        return console.log(response);
      }
    });
  };

  $('form.sign-up').submit(function(event) {
    var email, name;
    event.preventDefault();
    email = EMAIL_INPUT.val().trim();
    name = NAME_INPUT.val().trim();
    if (email && name) {
      return $.ajax({
        url: '/is-valid-email',
        type: 'POST',
        data: {
          'email': email
        },
        success: function(isValidEmail) {
          console.log(isValidEmail);
          if (isValidEmail === true) {
            clearFieldErrors();
            return submitSignUpForm(email, name);
          } else {
            EMAIL_INPUT.addClass('error');
            return false;
          }
        }
      });
    } else {
      clearFieldErrors();
      return addErrorsToEmptyFields(email, name);
    }
  });

  addErrorsToEmptyFields = function(email, name) {
    if (!email) {
      EMAIL_INPUT.addClass('error');
    }
    if (!name) {
      return NAME_INPUT.addClass('error');
    }
  };

  clearFieldErrors = function() {
    EMAIL_INPUT.removeClass('error');
    return NAME_INPUT.removeClass('error');
  };

}).call(this);
