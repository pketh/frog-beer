// Generated by CoffeeScript 1.9.0
(function() {
  var GetQueryStringParams, accountCookie, greetings, randomGreeting, signUpToken;

  GetQueryStringParams = function(param) {
    var URLVariable, URLVariables, i, pageURL, parameterName, _i, _len;
    pageURL = window.location.search.substring(1);
    URLVariables = pageURL.split('&');
    for (i = _i = 0, _len = URLVariables.length; _i < _len; i = ++_i) {
      URLVariable = URLVariables[i];
      parameterName = URLVariables[i].split('=');
      if (parameterName[0] === param) {
        return parameterName[1];
      }
    }
  };

  signUpToken = GetQueryStringParams('signUpToken');

  accountCookie = Cookies.get().accountToken;

  greetings = ['Aloha', 'Ciao', '今日は', 'Hello', 'Hola', 'Bonjour'];

  if (accountCookie) {
    randomGreeting = _.sample(greetings);
    $('.greeting').html(randomGreeting);
    $.ajax({
      url: '/get-user-name',
      type: 'POST',
      data: {
        'accountCookie': accountCookie
      },
      success: function(response) {
        var userName;
        userName = response;
        return $('.user-name').html(userName);
      }
    });
  } else if (signUpToken) {
    $.ajax({
      url: '/add-account-token',
      type: 'POST',
      data: {
        'signUpToken': signUpToken
      },
      success: function(response) {
        var accountToken;
        accountToken = response;
        Cookies.set('accountToken', accountToken, {
          expires: 10000
        });
        return console.log("cookie saved! " + accountToken);
      }
    });
  }

}).call(this);
